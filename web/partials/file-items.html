<div ng-controller="ButtonsController">
  <div class="alert alert-info alert-dismissable" ng-show="fileListStatus.latestAction === 'trash'">
    <span translate="storage-client.moved-to-trash"></span>
  </div>
  <div class="alert alert-info alert-dismissable" ng-show="fileListStatus.latestAction === 'restore'">
    <span translate="storage-client.restored-from-trash"></span>
  </div>
</div>
<div ng-controller="FileListCtrl" id="list">
<div class="alert alert-info alert-dismissable" ng-show="statusDetails.code===202">
  <span translate="storage-client.requesting-file-list"></span>
</div>
<div ng-class="{alert:true, 'alert-info':(bucketCreationStatus.code < 300), 'alert-danger':(bucketCreationStatus.code > 299), 'alert-dismissable':true}" ng-show="statusDetails.code===404">
  <button class="btn btn-success btn-fixed-width" type="button" ng-click="createBucket()">
    <span title="{{ 'storage-client.create-initial-folder' | translate }}">
      <span translate="storage-client.create-initial-folder"></span> <i class="fa fa-white fa-check icon-right"></i>
    </span>
  </button>
  <span ng-show="bucketCreationStatus.code > 299">
    <span translate="storage-client.create-initial-folder-failed" translate-values="{ email: bucketCreationStatus.userEmail }"></span>
  </span>
</div>
<div class="alert alert-danger" ng-show="statusDetails.code===403">
  <span translate="storage-client.not-authorized"></span>
</div>
<div id="cookieTester" ng-controller="cookieTesterController as cookieController">
  <div class="alert alert-danger" ng-show="!cookieController.status.passed">
      {{cookieController.status.message}}
  </div>
  <div ng-hide="!cookieController.status.passed">
    <div id="gapiLoadNotice" class="alert alert-danger" ng-controller="gapiClientController as gapiController" ng-show="!gapiController.gapiClientFullyLoaded">
      <span translate="storage-client.loading-functions"></span>
    </div>

    <div id="oauthNotice" class="alert alert-danger" ng-hide="statusDetails.code !== 401 && statusDetails.code !== 400 && isAuthed === true">
      <span translate="common.required-credentials"></span>
      <button class="btn btn-primary btn-sm" type="button" ng-click="login()">
        <span title="{{ 'storage-client.permission-request' | translate }}" 
              class="fa fa-check"> <span translate="common.ok"></span></span>
      </button>
    </div>
  </div>
</div>
<div>
<table id="filesTable" class="table table-hover filetable" ng-show="statusDetails.code!==202 && statusDetails.code!==404">
  <thead>
    <tr>
      <th class="check-col">
        <input type="checkbox" ng-model="selectAll" ng-change="selectAllCheckboxes()">
      </th>
      <th class="" ng-click="orderByAttribute = fileNameOrderFunction; reverseSort = !reverseSort">
        <a href=""><span translate="common.file-name"></span>
          <span ng-show="orderByAttribute==fileNameOrderFunction">
            <span ng-show="reverseSort">
              <i class="fa fa-sort-asc"></i>
            </span>
            <span ng-show="!reverseSort">
              <i class="fa fa-sort-desc"></i>
            </span>
          </span>
        </a>
      </th>
      <th class="type-col text-right hidden-xs" ng-click="orderByAttribute = fileExtOrderFunction; reverseSort = !reverseSort">
        <a href=""><span translate="common.file-type"></span>
          <span ng-show="orderByAttribute==fileExtOrderFunction">
            <span ng-show="reverseSort">
              <i class="fa fa-sort-asc"></i>
            </span>
            <span ng-show="!reverseSort">
              <i class="fa fa-sort-desc"></i>
            </span>
          </span>
        </a>
      </th>
      <th class="filesize-col text-right hidden-xs" ng-click="orderByAttribute = fileSizeOrderFunction; reverseSort = !reverseSort">
        <a href=""><span translate="common.file-size"></span>
          <span ng-show="orderByAttribute==fileSizeOrderFunction">
            <span ng-show="reverseSort">
              <i class="fa fa-sort-asc"></i>
            </span>
            <span ng-show="!reverseSort">
              <i class="fa fa-sort-desc"></i>
            </span>
          </span>
        </a>
      </th>
      <th class="datemod-col text-right hidden-xs" ng-click="orderByAttribute = dateModifiedOrderFunction; reverseSort = !reverseSort">
        <a href=""><span translate="common.file-date-mod"></span>
          <span ng-show="orderByAttribute==dateModifiedOrderFunction">
            <span ng-show="reverseSort">
              <i class="fa fa-sort-desc"></i>
            </span>
            <span ng-show="!reverseSort">
              <i class="fa fa-sort-asc"></i>
            </span>
          </span>
        </a>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr ng-repeat="file in filesDetails.files | filter:query | orderBy:orderByAttribute:reverseSort" ng-class="{active: file.isChecked}">
      <td class="check-col">
        <input type="checkbox" ng-model="file.isChecked" ng-change="fileCheckToggled(file)" ng-show="!fileIsCurrentFolder(file) && !fileIsTrash(file)">
      </td>
      <td class="file-name" ng-class="fileIsFolder(file) ? 'folder-type' : ''">
        <a ng-show="!fileIsFolder(file) && storageFull" class="non-clickable-file" href="" data-toggle="tooltip" title="{{file.name | fileNameFilter:currentDecodedFolder}}"><i class="fa fa-file"></i> {{file.name | fileNameFilter:currentDecodedFolder}}</a>
        <a ng-show="fileIsFolder(file) || !storageFull" href="" data-toggle="tooltip" title="{{file.name | fileNameFilter:currentDecodedFolder}}" ng-click="$emit('FileSelectAction', file)"><i class="fa" ng-class="fileIsFolder(file) ? 'fa-folder' : 'fa-file'"></i> {{file.name | fileNameFilter:currentDecodedFolder}}</a>
      </td>
      <td class="type-col text-right hidden-xs">
        <span>{{file.name | fileTypeFilter}}</span>
      </td>
      <td class="filesize-col text-right hidden-xs">
        <span> {{file.size | fileSizeFilter}}</span>
      </td>
      <td class="datemod-col text-right hidden-xs">
        <span> {{file.updated | lastModifiedFilter}}</span>
      </td>
    </tr>
  </tbody>
</table>
</div>
</div>
